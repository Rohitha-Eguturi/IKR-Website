<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTP Verification - Secure Login and OTP Template</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for 'Inter' font -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary-red': '#C8102E', // Mimicking the deep red from the button
                        'sub-text': '#525252',
                        'nav-bg': '#333333', // Dark background for the sidebar
                        'nav-active': '#C8102E', // Red for active menu item
                        'pasti-red': '#C8102E', // Alias for the primary red color
                        'pasti-dark': '#1e1e1e', // Darker background color for a more professional feel
                    }
                }
            }
        }
    </script>
    <!-- Inter Font Import -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <!-- Custom Style for the distinct logo text -->
    <style>
        .logo-text {
            font-family: 'Dancing Script', cursive; /* Using a cursive font to simulate the unique logo */
            font-size: 3rem;
            line-height: 1;
            color: #C8102E;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .app-logo-text {
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            color: #ffffff;
            font-weight: 700;
        }
        /* Styling for the red bar under the search/reset buttons */
        .search-container {
            border-bottom: 3px solid #C8102E;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
    </style>
    <!-- Import a beautiful script font for the logo -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-0 md:p-4 font-sans">

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="absolute inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 transition-opacity duration-300 hidden">
        <div class="flex flex-col items-center">
            <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-primary-red"></div>
            <p class="mt-4 text-white text-sm">Initializing...</p>
        </div>
    </div>

    <!-- OTP Verification Card Container -->
    <div id="otpCard" class="w-full max-w-sm bg-white rounded-xl shadow-2xl overflow-hidden transform transition duration-500 hidden">
        <!-- Header Section -->
        <div class="p-8 text-center border-b border-gray-100">
            <h2 class="text-2xl font-semibold text-gray-800 mb-2">Verify Your Account</h2>
            <p class="text-sm text-sub-text">An OTP has been sent to your email. Please check your inbox.</p>
        </div>

        <!-- OTP Input Form -->
        <div class="p-8 space-y-6">
            <form id="otpForm" class="space-y-6" onsubmit="handleOtpVerification(event)">
                 <!-- Custom Message Box for OTP -->
                <div id="otpMessageBox" class="hidden p-3 rounded-lg text-sm transition-all duration-300 mt-4" role="alert"></div>

                <div class="relative">
                    <input type="text" id="otpInput" placeholder="Enter 6-digit OTP (123456)" required maxlength="6"
                           class="w-full pl-12 pr-4 py-3 text-center border border-gray-300 rounded-lg focus:ring-primary-red focus:border-primary-red transition duration-150 text-sub-text placeholder-gray-400 focus:outline-none shadow-sm tracking-widest text-lg">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                        <!-- Key Icon (SVG from Lucide) -->
                         <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a5.25 5.25 0 0 0-5.25 5.25c0 3.75 5.25 10.5 5.25 10.5s5.25-6.75 5.25-10.5A5.25 5.25 0 0 0 12 3z"/><path d="M12 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
                    </span>
                </div>

                <!-- Verify Button -->
                <button type="submit" id="verifyOtpButton"
                        class="w-full flex items-center justify-center py-3 bg-green-600 text-white font-semibold rounded-lg shadow-lg hover:bg-green-700 transition duration-300 ease-in-out transform hover:scale-[1.01] active:scale-[0.99] focus:outline-none focus:ring-4 focus:ring-green-600 focus:ring-opacity-50 disabled:opacity-50 disabled:cursor-not-allowed">
                    <span id="verifyButtonLoading" class="hidden animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></span>
                    <span id="verifyButtonLabel">VERIFY & CONTINUE</span>
                </button>
            </form>

            <!-- Resend Link -->
            <div class="text-center text-xs text-sub-text space-y-2">
                <p>Did not receive the code?</p>
                <a href="#" onclick="resendOtp(event)" id="resendLink" class="text-primary-red font-medium hover:underline transition duration-150 inline-block">Resend OTP</a>
                <p class="text-xs text-gray-400 mt-2">Simulated OTP: 123456</p>
            </div>

        </div>

         <!-- Footer Section -->
        <div class="p-4 text-center text-xs text-gray-400 border-t border-gray-100">
            &copy; 2024 Placeholder Corporation
        </div>
    </div>

    <script>
        // --- LOCAL STORAGE SETUP ---
        let isAuthReady = true; // Always ready for local storage

        const loadingOverlay = document.getElementById('loadingOverlay');
        const otpCard = document.getElementById('otpCard');
        const verifyOtpButton = document.getElementById('verifyOtpButton');
        const verifyButtonLoading = document.getElementById('verifyButtonLoading');
        const verifyButtonLabel = document.getElementById('verifyButtonLabel');

        // Define simulated OTP
        const SIMULATED_OTP = '123456';

        // Global utility function for displaying messages (replaces alert())
        window.displayMessage = function(text, isError = true, messageBoxId = 'otpMessageBox') {
            const box = document.getElementById(messageBoxId);
            if (!box) return;

            box.textContent = text;
            box.classList.remove('hidden', 'bg-red-100', 'text-red-700', 'bg-green-100', 'text-green-700');

            if (isError) {
                box.classList.add('bg-red-100', 'text-red-700');
            } else {
                box.classList.add('bg-green-100', 'text-green-700');
            }

            // Show the box (in case it was hidden by the timeout before)
            box.classList.remove('hidden');

            setTimeout(() => {
                box.classList.add('hidden');
            }, 5000);
        }

        function toggleOtpLoading(isLoading) {
            verifyOtpButton.disabled = isLoading;
            verifyButtonLoading.classList.toggle('hidden', !isLoading);
            verifyButtonLabel.textContent = isLoading ? 'VERIFYING...' : 'VERIFY & CONTINUE';
        }

        function initializeApp() {
            loadingOverlay.classList.remove('hidden');

            // Simulate initialization delay
            setTimeout(() => {
                loadingOverlay.classList.add('hidden');

                // Check if user has login state, otherwise redirect to login
                const simulatedLogin = localStorage.getItem('simulated_login');
                const otpPassed = localStorage.getItem('simulated_otp_passed');

                if (!simulatedLogin) {
                    window.location.href = 'login.html';
                } else if (otpPassed === 'true') {
                    window.location.href = 'index.html';
                } else {
                    otpCard.classList.remove('hidden');
                }
            }, 500); // Shorter delay for OTP page
        }

        window.handleOtpVerification = async function(event) {
            event.preventDefault();
            toggleOtpLoading(true);

            const otp = document.getElementById('otpInput').value;
            const simulatedUserId = localStorage.getItem('simulated_login') || 'guest-user';

            // Simple client-side simulation delay
            await new Promise(resolve => setTimeout(resolve, 1000));

            try {
                if (otp === SIMULATED_OTP) {
                    // OTP Success!
                    displayMessage('Verification successful! Access granted.', false, 'otpMessageBox');

                    // Set OTP passed and redirect to dashboard
                    localStorage.setItem('simulated_otp_passed', 'true');
                    setTimeout(() => window.location.href = 'index.html', 1000);

                } else {
                    // OTP Failure
                    displayMessage("Verification failed: Incorrect OTP. Please try again.", true, 'otpMessageBox');
                }

            } catch (error) {
                console.error("OTP verification failed:", error);
                displayMessage(`Verification failed unexpectedly: ${error.message}`, true, 'otpMessageBox');
            } finally {
                toggleOtpLoading(false);
            }
        }

        window.resendOtp = async function(event) {
            event.preventDefault();
             // Prevent multiple clicks immediately
            const resendLink = document.getElementById('resendLink');
            resendLink.classList.add('opacity-50', 'cursor-not-allowed');
            resendLink.onclick = (e) => e.preventDefault();

            displayMessage('Sending new OTP...', false, 'otpMessageBox');

            // Simulate API call delay
            await new Promise(resolve => setTimeout(resolve, 2000));

            displayMessage('New OTP sent successfully! (Still 123456)', false, 'otpMessageBox');
            document.getElementById('otpInput').value = ''; // Clear input

            // Re-enable the link after a cooldown
            setTimeout(() => {
                resendLink.classList.remove('opacity-50', 'cursor-not-allowed');
                resendLink.onclick = resendOtp;
            }, 5000);
        }

        // Start initialization on window load
        initializeApp();
    </script>
</body>
</html>
